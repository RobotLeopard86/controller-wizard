import{d as W,k as H,r as C,l as Y,b as X,c as m,e as T,m as _,w as u,u as s,n as P,f as c,t as N,h as p,F as q,i as z,p as D,j as V}from"./index-C0NjyC6b.js";import{Q as $,X as R,D as F,i as U,B as Z,Z as x}from"./flowbite-vue-UDwxbwO-.js";const ee="/controller.png";var B=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function te(w){return w&&w.__esModule&&Object.prototype.hasOwnProperty.call(w,"default")?w.default:w}var I={exports:{}};(function(w,S){(function(i,n){n()})(B,function(){function i(o,a){return typeof a>"u"?a={autoBom:!1}:typeof a!="object"&&(console.warn("Deprecated: Expected third argument to be a object"),a={autoBom:!a}),a.autoBom&&/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(o.type)?new Blob(["\uFEFF",o],{type:o.type}):o}function n(o,a,h){var r=new XMLHttpRequest;r.open("GET",o),r.responseType="blob",r.onload=function(){d(r.response,a,h)},r.onerror=function(){console.error("could not download file")},r.send()}function e(o){var a=new XMLHttpRequest;a.open("HEAD",o,!1);try{a.send()}catch{}return 200<=a.status&&299>=a.status}function k(o){try{o.dispatchEvent(new MouseEvent("click"))}catch{var a=document.createEvent("MouseEvents");a.initMouseEvent("click",!0,!0,window,0,0,0,80,20,!1,!1,!1,!1,0,null),o.dispatchEvent(a)}}var g=typeof window=="object"&&window.window===window?window:typeof self=="object"&&self.self===self?self:typeof B=="object"&&B.global===B?B:void 0,A=g.navigator&&/Macintosh/.test(navigator.userAgent)&&/AppleWebKit/.test(navigator.userAgent)&&!/Safari/.test(navigator.userAgent),d=g.saveAs||(typeof window!="object"||window!==g?function(){}:"download"in HTMLAnchorElement.prototype&&!A?function(o,a,h){var r=g.URL||g.webkitURL,f=document.createElement("a");a=a||o.name||"download",f.download=a,f.rel="noopener",typeof o=="string"?(f.href=o,f.origin===location.origin?k(f):e(f.href)?n(o,a,h):k(f,f.target="_blank")):(f.href=r.createObjectURL(o),setTimeout(function(){r.revokeObjectURL(f.href)},4e4),setTimeout(function(){k(f)},0))}:"msSaveOrOpenBlob"in navigator?function(o,a,h){if(a=a||o.name||"download",typeof o!="string")navigator.msSaveOrOpenBlob(i(o,h),a);else if(e(o))n(o,a,h);else{var r=document.createElement("a");r.href=o,r.target="_blank",setTimeout(function(){k(r)})}}:function(o,a,h,r){if(r=r||open("","_blank"),r&&(r.document.title=r.document.body.innerText="downloading..."),typeof o=="string")return n(o,a,h);var f=o.type==="application/octet-stream",O=/constructor/i.test(g.HTMLElement)||g.safari,L=/CriOS\/[\d]+/.test(navigator.userAgent);if((L||f&&O||A)&&typeof FileReader<"u"){var M=new FileReader;M.onloadend=function(){var b=M.result;b=L?b:b.replace(/^data:[^;]*;/,"data:attachment/file;"),r?r.location.href=b:location=b,r=null},M.readAsDataURL(o)}else{var j=g.URL||g.webkitURL,y=j.createObjectURL(o);r?r.location=y:location.href=y,r=null,setTimeout(function(){j.revokeObjectURL(y)},4e4)}});g.saveAs=d.saveAs=d,w.exports=d})})(I);var ne=I.exports;const K=te(ne),oe=w=>{w.forEach(async S=>{const i=await(await fetch("/diagram_template.svg")).text(),n=new DOMParser().parseFromString(i,"image/svg+xml");n.querySelector("#title").innerHTML=S.name;let e=new Map;S.mappings.forEach(d=>{e.set(d.trigger,d.action)}),n.querySelector("#a").innerHTML=e.get("A")||"No Action",n.querySelector("#b").innerHTML=e.get("B")||"No Action",n.querySelector("#x").innerHTML=e.get("X")||"No Action",n.querySelector("#y").innerHTML=e.get("Y")||"No Action",n.querySelector("#left-trigger").innerHTML=e.get("Left Trigger")||"No Action",n.querySelector("#left-button").innerHTML=e.get("Left Shoulder")||"No Action",n.querySelector("#right-trigger").innerHTML=e.get("Right Trigger")||"No Action",n.querySelector("#right-button").innerHTML=e.get("Right Shoulder")||"No Action",n.querySelector("#left-trigger").innerHTML=e.get("Left Trigger")||"No Action",n.querySelector("#left-button").innerHTML=e.get("Left Shoulder")||"No Action",n.querySelector("#start").innerHTML=e.get("Start")||"No Action",n.querySelector("#back").innerHTML=e.get("Back")||"No Action",n.querySelector("#dpad-r").innerHTML=e.get("D-Pad Right")||"No Action",n.querySelector("#dpad-l").innerHTML=e.get("D-Pad Left")||"No Action",n.querySelector("#dpad-u").innerHTML=e.get("D-Pad Up")||"No Action",n.querySelector("#dpad-d").innerHTML=e.get("D-Pad Down")||"No Action",n.querySelector("#lstick").innerHTML=e.get("Left Stick")||"No Action",n.querySelector("#lstick-press").innerHTML="Press: "+(e.get("Left Stick Press")||"No Action"),n.querySelector("#rstick").innerHTML=e.get("Right Stick")||"No Action",n.querySelector("#rstick-press").innerHTML="Press: "+(e.get("Right Stick Press")||"No Action");const g='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 800 500">'+n.documentElement.innerHTML+"</svg>";let A=S.name.replace(" ","_")+".svg";K.saveAs(new Blob([g]),A)})},ae={class:"col-span-2 flex items-center justify-end"},le=["onClick"],re={class:"grid grid-cols-4 gap-4"},ie={class:"grid grid-cols-3 min-h-screen w-screen gap-8"},se={class:"bg-slate-900 rounded-xl backdrop-opacity-100 h-full my-auto grid grid-cols-1 grid-rows-5"},ue={class:"row-span-4"},ce={class:"font-extrabold text-3xl text-white text-center"},de={class:"col-span-2 flex items-center justify-end"},fe=["onClick"],pe={class:"text-xs"},ge={class:"row-span-1 justify-center items-center grid grid-cols-2 gap-56"},ve=["onClick"],we=W({__name:"EditorView",setup(w){const S=z(),i=H(()=>S.state.value),n=C(!1),e=C({name:"NO SCHEME",mappings:[]}),k=H(()=>e.value.name==="NO SCHEME"),g=()=>{n.value=!0},A=()=>{i.value.length===0?e.value={name:"NO SCHEME",mappings:[]}:k.value&&(e.value=i.value[0]),n.value=!1},d=C("");Y(()=>{(i.value==null||i.value==null||!i.value.forEach)&&X.replace("/"),i.value.length>0&&(e.value=i.value[0])});const o=()=>{let v=!1;return i.value.forEach(l=>{v=d.value===l.name}),!v&&d.value!==""&&d.value!==void 0},a=H(()=>!o()),h=()=>{let v={name:d.value,mappings:[]},t=i.value;t.push(v),S.commit("manipulate",t),d.value=""},r=v=>{let t=i.value.filter(l=>l.name!==v);S.commit("manipulate",t)},f=v=>{let t=e.value.mappings.filter(l=>l.trigger!==v);e.value.mappings=t,i.value.forEach((l,E)=>{l.name===e.value.name&&(i.value[E]=e.value)})},O=()=>{let v=new Blob([JSON.stringify(i.value)]);K.saveAs(v,"project.json")},L=()=>["A","B","X","Y","Left Trigger","Left Shoulder","Right Trigger","Right Shoulder","Back","Start","Left Stick","Right Stick","Left Stick Press","Right Stick Press","D-Pad Left","D-Pad Right","D-Pad Up","D-Pad Down"].filter(t=>e.value.mappings.filter(l=>l.trigger===t).length===0),M=C("A"),j=H(()=>k.value?"<Input>":L().includes(M.value)?M.value:"<Input>"),y=C(""),b=H(()=>y.value===void 0||y.value===""||j.value==="<Input>"),G=()=>{const v={action:y.value,trigger:M.value};let t=e.value.mappings;t.push(v),e.value.mappings=t,i.value.forEach((l,E)=>{l.name===e.value.name&&(i.value[E]=e.value)}),M.value=L()[0],y.value=""},J=()=>{confirm(`Are you sure you want to exit?
Warning: If you have not saved this diagram, it will be lost by exiting the editor!`)&&(S.commit("manipulate",[]),X.push("/"))},Q=H(()=>L().length>0);return(v,t)=>(m(),T(q,null,[n.value?(m(),_(s($),{key:0,onClose:A},{header:u(()=>t[3]||(t[3]=[c("h1",{class:"text-white text-3xl font-bold"},"Manage Schemes",-1)])),body:u(()=>[p(s(R),{class:"min-w-full"},{default:u(()=>[(m(!0),T(q,null,D(i.value,l=>(m(),_(s(x),{class:"grid grid-cols-3 gap-3"},{default:u(()=>[c("div",null,[c("span",null,N(l.name),1)]),c("div",ae,[(m(),T("svg",{onClick:()=>r(l.name),class:"w-6 h-6 text-red-500","aria-hidden":"true",xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",fill:"none",viewBox:"0 0 24 24"},t[4]||(t[4]=[c("path",{stroke:"currentColor","stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M5 7h14m-9 3v8m4-8v8M10 3h4a1 1 0 0 1 1 1v3H9V4a1 1 0 0 1 1-1ZM6 7h12v13a1 1 0 0 1-1 1H7a1 1 0 0 1-1-1V7Z"},null,-1)]),8,le))])]),_:2},1024))),256))]),_:1})]),footer:u(()=>[c("div",re,[p(s(Z),{modelValue:d.value,"onUpdate:modelValue":t[0]||(t[0]=l=>d.value=l),class:"col-span-3",placeholder:"Enter new scheme name here"},null,8,["modelValue"]),p(s(U),{color:"yellow",disabled:a.value,onClick:h},{default:u(()=>t[5]||(t[5]=[V("Add Scheme")])),_:1},8,["disabled"])])]),_:1})):P("",!0),c("div",ie,[c("div",se,[c("div",ue,[c("h1",ce,N(e.value.name),1),k.value?P("",!0):(m(),_(s(R),{key:0,class:"min-w-full min-h-full overflow-y-scroll"},{default:u(()=>[(m(!0),T(q,null,D(e.value.mappings,l=>(m(),_(s(x),{class:"grid grid-cols-3 gap-3"},{default:u(()=>[c("div",null,[c("span",null,N(l.trigger)+" -> "+N(l.action),1)]),c("div",de,[(m(),T("svg",{onClick:()=>f(l.trigger),class:"w-6 h-6 text-red-500","aria-hidden":"true",xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",fill:"none",viewBox:"0 0 24 24"},t[6]||(t[6]=[c("path",{stroke:"currentColor","stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M5 7h14m-9 3v8m4-8v8M10 3h4a1 1 0 0 1 1 1v3H9V4a1 1 0 0 1 1-1ZM6 7h12v13a1 1 0 0 1-1 1H7a1 1 0 0 1-1-1V7Z"},null,-1)]),8,fe))])]),_:2},1024))),256)),Q.value?(m(),_(s(x),{key:0,class:"grid grid-cols-3 gap-3"},{default:u(()=>[p(s(F),{placement:"bottom",text:j.value,"close-inside":"",color:"yellow"},{default:u(()=>[p(s(R),{class:"overflow-y-scroll max-h-48"},{default:u(()=>[(m(!0),T(q,null,D(L(),l=>(m(),_(s(x),{onClick:()=>M.value=l},{default:u(()=>[c("span",pe,N(l),1)]),_:2},1032,["onClick"]))),256))]),_:1})]),_:1},8,["text"]),p(s(Z),{modelValue:y.value,"onUpdate:modelValue":t[1]||(t[1]=l=>y.value=l)},null,8,["modelValue"]),p(s(U),{color:"yellow",onClick:G,disabled:b.value},{default:u(()=>t[7]||(t[7]=[V("+")])),_:1},8,["disabled"])]),_:1})):P("",!0)]),_:1}))]),c("div",ge,[p(s(F),{placement:"right",text:"Schemes","align-to-end":"",color:"yellow"},{default:u(()=>[p(s(R),null,{default:u(()=>[(m(!0),T(q,null,D(i.value,l=>(m(),_(s(x),null,{default:u(()=>[c("span",{onClick:()=>{i.value.forEach(E=>{E.name===l.name&&(e.value=E)})}},N(l.name),9,ve)]),_:2},1024))),256)),p(s(x),null,{default:u(()=>[c("span",{onClick:g},"Manage Schemes")]),_:1})]),_:1})]),_:1}),p(s(F),{placement:"left",text:"Save","align-to-end":"",color:"yellow"},{default:u(()=>[p(s(R),null,{default:u(()=>[p(s(x),null,{default:u(()=>[c("span",{onClick:O},"Save as Project File")]),_:1}),p(s(x),null,{default:u(()=>[c("span",{onClick:t[2]||(t[2]=()=>s(oe)(i.value))},"Export")]),_:1})]),_:1})]),_:1})])]),t[9]||(t[9]=c("div",{class:"col-span-2 rounded-xl h-5/6 my-auto flex flex-col items-center justify-center"},[c("img",{src:ee,alt:"Controller",class:"w-2/3 h-5/6"})],-1)),p(s(U),{color:"red",class:"absolute right-0",onClick:J},{default:u(()=>t[8]||(t[8]=[V("X")])),_:1})])],64))}});export{we as default};
